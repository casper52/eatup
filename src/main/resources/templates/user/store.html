<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/layout/layout_user}">



<div layout:fragment="content">
	<!-- Add icon library -->
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<style>
* {
	margin: 0px;
	padding: 0px;
}

.menuContent {
	item-align: center;
	text-align: center;
	margin: auto;
}

.col-lg-9 {
	text-align: center;
}

.facet {
	background-color: #E9CC44;
}

.f1 {
	height: 100px;
}

.cartBtn {
	height: 100px;
	width: 100%;
	background-color: transparent;
}

.checked {
	color: orange;
}

.FixedLayoutBottom {
	position: fixed;
	bottom: 0px;
	width: 100%;
}

.css_layout_Bottom {
	text-align: center;
	background-color: #FFD700;
	color: black;
	height: 100px;
	line-height: 100px;
	color: black;
}

.carousel-inner img {
	margin: auto;
}

.card h-100 img {
	display: block;
	margin-left: auto;
	margin-right: auto;
	width: 200px;
	height: 150px;
}

.modal {
	item-align: center;
	text-align: center;
	margin: auto;
}
</style>


	<!-- content -->


<div class="getMenu"></div>
	<div class="menuContent col-lg-9">
		<h1 th:text="${menu[0].sname}"></h1>
		<span class="fa fa-star checked"></span> <span
			class="fa fa-star checked"></span> <span class="fa fa-star checked"></span>
		<span class="fa fa-star"></span> <span class="fa fa-star"></span>
<!-- 		<div id="carouselExampleIndicators" class="carousel slide my-4"
			data-ride="carousel">
			<ol class="carousel-indicators">
				<li data-target="#carouselExampleIndicators" data-slide-to="0"
					class="active"></li>
				<li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
				<li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
			</ol>
			<div class="carousel-inner" role="listbox">
				<div class="carousel-item active">
					<img class=" d-block img-fluid" src="../imgs/cafe1.jpg"
						width="750px" height="500px" alt="First slide">
				</div>
				<div class="carousel-item">
					<img class="d-block img-fluid" src="../imgs/cafe2.jpg"
						width="750px" height="500px" alt="Second slide">
				</div>
				<div class="carousel-item">
					<img class="d-block img-fluid" src="../imgs/cafe5.jpg"
						width="750px" height="500px" alt="Third slide">
				</div>
			</div>
			<a class="carousel-control-prev" href="#carouselExampleIndicators"
				role="button" data-slide="prev"> <span
				class="carousel-control-prev-icon" aria-hidden="true"></span> <span
				class="sr-only">Previous</span>
			</a> <a class="carousel-control-next" href="#carouselExampleIndicators"
				role="button" data-slide="next"> <span
				class="carousel-control-next-icon" aria-hidden="true"></span> <span
				class="sr-only">Next</span>
			</a>
		</div> -->

		<div class="container">
			<div class="wrapper"></div>
		</div>

		<div class="row">
			<div class="col-lg-4 col-md-6 mb-4"
				th:each="menu, iterState : ${menu}">

				<div class="card h-100">
						<img
						th:src="@{/upload/display(fileName=${menu.upload_path +'\/s_'+ menu.uuid + '_'+menu.fname})}"
						class="menuImg">

					<div class="card-body">

						<h6 th:text="${menu.mname}" class="card-title"></h6>
						<input type="hidden" th:value="${menu.mno}">
						<p th:text="${menu.mprice}" class="card-text"></p>
						<p th:text="${menu.introduction}" class="card-text"></p>
					</div>

					<div class="card-footer">
						<span class="fa fa-star checked"></span> <span
							class="fa fa-star checked"></span> <span
							class="fa fa-star checked"></span> <span class="fa fa-star"></span>
						<span class="fa fa-star"></span>
					</div>
				</div>

			</div>
			<!-- /.row -->

		</div>
		<!-- /.col-lg-9 -->

	</div>
	<!-- /.row -->


	<div class="modal" id="myModal" tabindex="-1" role="dialog">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">주문하기</h5>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span class="modalclose" aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
				<form id="getOrderForm" method="get">
					<div class="col-md-7">
						<a href="#"> <img class="img-fluid rounded mb-3 mb-md-0"
							width="100px" alt="">
						</a>
					</div>
					<div class="col-md-5">
						<h6 id="mname"></h6>
						<p id="mprice"></p>
						<p>수량</p>
						<div id=""class="number">

							<button id="decreaseQuantity" class="btn btn-light">-</button>
							<span id="numberUpDown">1</span>
							<button id="increaseQuantity" class="btn btn-light">+</button>
						</div>
					</div>
					<div class="modal-footer">
<!-- 						<button id="cart" type="button" class="btn btn-primary"
						th:onclick="|window.location.href='@{/user/cart(sno=${menu[0].sno})}'|">장바구니</button> -->
						<button id="cart" type="button" class="btn btn-primary">장바구니</button>
						<button id="order" type="button" class="btn btn-secondary"
						th:onclick="|window.location.href='@{/user/pay(sno=${menu[0].sno})}'|"
							data-dismiss="modal">바로주문</button>
					</div>
					</form>
				</div>
			</div>
		</div>

		<!-- end content -->
	</div>

	<div class="FixedLayoutBottom css_layout_Bottom"
		th:onclick="|window.location.href='@{/user/cart(sno=${menu[0].sno})}'|">주문하기
		 <span id="badge" class="badge badge-pill badge-danger">1</span></div>
		
</div>





<th:block layout:fragment="script">
	<script th:inline="javascript">
$(document).ready(function() {
	
	var arr = new Array(); 
	
	
	//메뉴 클릭 모달
	$(".card-body").on("click", function(e) {

		var getSno = [[${menu[0].sno}]];
		var getMname = $(this).children()[0].outerText;
		var getMno = $(this).children()[1].defaultValue;
		var getMprice = $(this).children()[2].outerText;
		var getQuantity = "";
 
		console.log("modal show.....");		

		$("#mname").html(getMname);
		$("#mprice").html(getMprice);
		
		

		// quantity
		var stat = $('#numberUpDown').text();
		var num = parseInt(stat,10);
		
			// click '-' button
			$('#decreaseQuantity').click(function(e){
				e.preventDefault();
				num--;
				if(num<=0){
				alert('더이상 줄일수 없습니다.');
				num =1;
			}
			$('#numberUpDown').text(num);
			
			getQuantity = $('#numberUpDown').text();
		
			});

		
			// click '+' button
			$('#increaseQuantity').click(function(e){
				e.preventDefault();
				num++;
				$('#numberUpDown').text(num);	
				
				getQuantity = $('#numberUpDown').text();
			});
			
			// default quantity = 1
			getQuantity = $('#numberUpDown').text();

		
		$("#myModal").show();
		
		

		// cart 쿠키 생성
		$("#cart").one("click", function(e) {	
			
			// json으로 Data변환
			var jsonData = new Object();
			jsonData.sno = getSno;
			jsonData.mno = getMno;
			jsonData.quantity = getQuantity;

		
			arr.push(jsonData);
			var json = JSON.stringify(arr);
	
			console.log("jsonData: " + json);
			
			
			// cart 쿠키 설정 (expries는 유지일)
			$.cookie('cart', json, { expires: 1, path: '/'}); 	       
			console.log("cookie : " + $.cookie('cart')); 
			
			
			 $('#numberUpDown').text(1);
			console.log("modal close");
			$("#myModal").hide();
			
		});
		
		// order 쿠키 생성
		$("#order").one("click", function(e) {	
			
			// json으로 Data변환
			var jsonData = new Object();
			jsonData.sno = getSno;
			jsonData.mno = getMno;
			jsonData.quantity = getQuantity;
		
			arr.push(jsonData);
			var json = JSON.stringify(arr);
	
			console.log("jsonData: " + json);
			
			
			// 쿠키 설정 (expries는 유지일, path는 쿠키 보관하고 있을 경로)
			$.cookie('cart', json, { expires: 1, path: '/'}); 	       
			console.log("cookie : " + $.cookie('cart')); 
			
			
			 $('#numberUpDown').text(1);
			console.log("modal close");
			$("#myModal").hide();
			
		});
		
	});
	

	// 모달 close
	$(".modalclose").on("click", function(e) {

		console.log("modal close");
		
		 $('#numberUpDown').text(1);
		 
		$("#myModal").hide();

	});


	
	
		// 장바구니 하단 div - 스크롤 위치를 퍼센트로 나타내기
		$(window).scroll(function() {
		scrollPercent = ($(window)
				.scrollTop() / ($(
				document).height() - $(
				window).height())) * 100;
		});

		$(window).scroll(function() {
		// Change this to target a different percentage
		var targetPercentage = 70;
		//Change this to the ID of the content you are trying to show.
		var targetID = "#container-fluid";
		//Window Math
		var scrollTo = $(window)
				.scrollTop(), docHeight = $(
				document).height(), windowHeight = $(
				window).height();
		scrollPercent = (scrollTo / (docHeight - windowHeight)) * 100;
		//스크롤 표시
		$('#percentageCounter h1')
				.text(scrollPercent+ "%");
		//네비바 보이기
		if (scrollPercent > targetPercentage) {
			$(targetID).css({
				top : '0'
			});
		} else {
			$(targetID).css(
							{
								top : '-'+ $(targetID).height+ 'px'
							});
		}
	}).trigger('scroll');


});
	</script>
</th:block>